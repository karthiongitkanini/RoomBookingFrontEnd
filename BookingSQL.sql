CREATE DATABASE RoomBookingDatabase
CREATE TABLE UserBookingDetails (UserId INT , RoomName VARCHAR(20), TimeSlot VARCHAR(30))

DROP TABLE UserBookingDetails
SELECT * FROM UserBookingDetails

CREATE TABLE RoomDetails (RoomName VARCHAR(20), TimeSlot VARCHAR(20),StatusOfRoom VARCHAR(20))
DROP TABLE RoomDetails
INSERT INTO RoomDetails (RoomName,TimeSlot,StatusOfRoom)VALUES ('Pondy' ,'9-10', 'free' )
INSERT INTO RoomDetails (RoomName,TimeSlot,StatusOfRoom)VALUES ('Pondy' ,'10-11', 'free' )
INSERT INTO RoomDetails (RoomName,TimeSlot,StatusOfRoom)VALUES ('Pondy' ,'11-12', 'free' )
INSERT INTO RoomDetails (RoomName,TimeSlot,StatusOfRoom)VALUES ('Pondy' ,'12-1', 'free' )
INSERT INTO RoomDetails (RoomName,TimeSlot,StatusOfRoom)VALUES ('Pondy' ,'1-2', 'free' )
INSERT INTO RoomDetails (RoomName,TimeSlot,StatusOfRoom)VALUES ('Pondy' ,'2-3', 'free' )
INSERT INTO RoomDetails (RoomName,TimeSlot,StatusOfRoom)VALUES ('Pondy' ,'3-4', 'free' )
INSERT INTO RoomDetails (RoomName,TimeSlot,StatusOfRoom)VALUES ('Pondy' ,'4-5', 'free' )
INSERT INTO RoomDetails (RoomName,TimeSlot,StatusOfRoom)VALUES ('Pondy' ,'5-6', 'free' )
INSERT INTO RoomDetails (RoomName,TimeSlot,StatusOfRoom)VALUES ('Pondy' ,'6-7', 'free' )
INSERT INTO RoomDetails (RoomName,TimeSlot,StatusOfRoom)VALUES ('Pondy' ,'7-8', 'free' )
INSERT INTO RoomDetails (RoomName,TimeSlot,StatusOfRoom)VALUES ('Pondy' ,'8-9', 'free' )

INSERT INTO RoomDetails (RoomName,TimeSlot,StatusOfRoom)VALUES ('Mahabs' ,'9-10', 'free' )
INSERT INTO RoomDetails (RoomName,TimeSlot,StatusOfRoom)VALUES ('Mahabs' ,'10-11', 'free' )
INSERT INTO RoomDetails (RoomName,TimeSlot,StatusOfRoom)VALUES ('Mahabs' ,'11-12', 'free' )
INSERT INTO RoomDetails (RoomName,TimeSlot,StatusOfRoom)VALUES ('Mahabs' ,'12-1', 'free' )
INSERT INTO RoomDetails (RoomName,TimeSlot,StatusOfRoom)VALUES ('Mahabs' ,'1-2', 'free' )
INSERT INTO RoomDetails (RoomName,TimeSlot,StatusOfRoom)VALUES ('Mahabs' ,'2-3', 'free' )
INSERT INTO RoomDetails (RoomName,TimeSlot,StatusOfRoom)VALUES ('Mahabs' ,'3-4', 'free' )
INSERT INTO RoomDetails (RoomName,TimeSlot,StatusOfRoom)VALUES ('Mahabs' ,'4-5', 'free' )
INSERT INTO RoomDetails (RoomName,TimeSlot,StatusOfRoom)VALUES ('Mahabs' ,'5-6', 'free' )
INSERT INTO RoomDetails (RoomName,TimeSlot,StatusOfRoom)VALUES ('Mahabs' ,'6-7', 'free' )
INSERT INTO RoomDetails (RoomName,TimeSlot,StatusOfRoom)VALUES ('Mahabs' ,'7-8', 'free' )
INSERT INTO RoomDetails (RoomName,TimeSlot,StatusOfRoom)VALUES ('Mahabs' ,'8-9', 'free' )

INSERT INTO RoomDetails (RoomName,TimeSlot,StatusOfRoom)VALUES ('Bigboss' ,'9-10', 'free' )
INSERT INTO RoomDetails (RoomName,TimeSlot,StatusOfRoom)VALUES ('Bigboss' ,'10-11', 'free' )
INSERT INTO RoomDetails (RoomName,TimeSlot,StatusOfRoom)VALUES ('Bigboss' ,'11-12', 'free' )
INSERT INTO RoomDetails (RoomName,TimeSlot,StatusOfRoom)VALUES ('Bigboss' ,'12-1', 'free' )
INSERT INTO RoomDetails (RoomName,TimeSlot,StatusOfRoom)VALUES ('Bigboss' ,'1-2', 'free' )
INSERT INTO RoomDetails (RoomName,TimeSlot,StatusOfRoom)VALUES ('Bigboss' ,'2-3', 'free' )
INSERT INTO RoomDetails (RoomName,TimeSlot,StatusOfRoom)VALUES ('Bigboss' ,'3-4', 'free' )
INSERT INTO RoomDetails (RoomName,TimeSlot,StatusOfRoom)VALUES ('Bigboss' ,'4-5', 'free' )
INSERT INTO RoomDetails (RoomName,TimeSlot,StatusOfRoom)VALUES ('Bigboss' ,'5-6', 'free' )
INSERT INTO RoomDetails (RoomName,TimeSlot,StatusOfRoom)VALUES ('Bigboss' ,'6-7', 'free' )
INSERT INTO RoomDetails (RoomName,TimeSlot,StatusOfRoom)VALUES ('Bigboss' ,'7-8', 'free' )
INSERT INTO RoomDetails (RoomName,TimeSlot,StatusOfRoom)VALUES ('Bigboss' ,'8-9', 'free' )

INSERT INTO RoomDetails (RoomName,TimeSlot,StatusOfRoom)VALUES ('Covelong' ,'9-10', 'free' )
INSERT INTO RoomDetails (RoomName,TimeSlot,StatusOfRoom)VALUES ('Covelong' ,'10-11', 'free' )
INSERT INTO RoomDetails (RoomName,TimeSlot,StatusOfRoom)VALUES ('Covelong' ,'11-12', 'free' )
INSERT INTO RoomDetails (RoomName,TimeSlot,StatusOfRoom)VALUES ('Covelong' ,'12-1', 'free' )
INSERT INTO RoomDetails (RoomName,TimeSlot,StatusOfRoom)VALUES ('Covelong' ,'1-2', 'free' )
INSERT INTO RoomDetails (RoomName,TimeSlot,StatusOfRoom)VALUES ('Covelong' ,'2-3', 'free' )
INSERT INTO RoomDetails (RoomName,TimeSlot,StatusOfRoom)VALUES ('Covelong' ,'3-4', 'free' )
INSERT INTO RoomDetails (RoomName,TimeSlot,StatusOfRoom)VALUES ('Covelong' ,'4-5', 'free' )
INSERT INTO RoomDetails (RoomName,TimeSlot,StatusOfRoom)VALUES ('Covelong' ,'5-6', 'free' )
INSERT INTO RoomDetails (RoomName,TimeSlot,StatusOfRoom)VALUES ('Covelong' ,'6-7', 'free' )
INSERT INTO RoomDetails (RoomName,TimeSlot,StatusOfRoom)VALUES ('Covelong' ,'7-8', 'free' )
INSERT INTO RoomDetails (RoomName,TimeSlot,StatusOfRoom)VALUES ('Covelong' ,'8-9', 'free' )


INSERT INTO RoomDetails (RoomName,TimeSlot,StatusOfRoom)VALUES ('Hibernate' ,'9-10', 'free' )
INSERT INTO RoomDetails (RoomName,TimeSlot,StatusOfRoom)VALUES ('Hibernate' ,'10-11', 'free' )
INSERT INTO RoomDetails (RoomName,TimeSlot,StatusOfRoom)VALUES ('Hibernate' ,'11-12', 'free' )
INSERT INTO RoomDetails (RoomName,TimeSlot,StatusOfRoom)VALUES ('Hibernate' ,'12-1', 'free' )
INSERT INTO RoomDetails (RoomName,TimeSlot,StatusOfRoom)VALUES ('Hibernate' ,'1-2', 'free' )
INSERT INTO RoomDetails (RoomName,TimeSlot,StatusOfRoom)VALUES ('Hibernate' ,'2-3', 'free' )
INSERT INTO RoomDetails (RoomName,TimeSlot,StatusOfRoom)VALUES ('Hibernate' ,'3-4', 'free' )
INSERT INTO RoomDetails (RoomName,TimeSlot,StatusOfRoom)VALUES ('Hibernate' ,'4-5', 'free' )
INSERT INTO RoomDetails (RoomName,TimeSlot,StatusOfRoom)VALUES ('Hibernate' ,'5-6', 'free' )
INSERT INTO RoomDetails (RoomName,TimeSlot,StatusOfRoom)VALUES ('Hibernate' ,'6-7', 'free' )
INSERT INTO RoomDetails (RoomName,TimeSlot,StatusOfRoom)VALUES ('Hibernate' ,'7-8', 'free' )
INSERT INTO RoomDetails (RoomName,TimeSlot,StatusOfRoom)VALUES ('Hibernate' ,'8-9', 'free' )


INSERT INTO RoomDetails (RoomName,TimeSlot,StatusOfRoom)VALUES ('Marina' ,'9-10', 'free' )
INSERT INTO RoomDetails (RoomName,TimeSlot,StatusOfRoom)VALUES ('Marina' ,'10-11', 'free' )
INSERT INTO RoomDetails (RoomName,TimeSlot,StatusOfRoom)VALUES ('Marina' ,'11-12', 'free' )
INSERT INTO RoomDetails (RoomName,TimeSlot,StatusOfRoom)VALUES ('Marina' ,'12-1', 'free' )
INSERT INTO RoomDetails (RoomName,TimeSlot,StatusOfRoom)VALUES ('Marina' ,'1-2', 'free' )
INSERT INTO RoomDetails (RoomName,TimeSlot,StatusOfRoom)VALUES ('Marina' ,'2-3', 'free' )
INSERT INTO RoomDetails (RoomName,TimeSlot,StatusOfRoom)VALUES ('Marina' ,'3-4', 'free' )
INSERT INTO RoomDetails (RoomName,TimeSlot,StatusOfRoom)VALUES ('Marina' ,'4-5', 'free' )
INSERT INTO RoomDetails (RoomName,TimeSlot,StatusOfRoom)VALUES ('Marina' ,'5-6', 'free' )
INSERT INTO RoomDetails (RoomName,TimeSlot,StatusOfRoom)VALUES ('Marina' ,'6-7', 'free' )
INSERT INTO RoomDetails (RoomName,TimeSlot,StatusOfRoom)VALUES ('Marina' ,'7-8', 'free' )
INSERT INTO RoomDetails (RoomName,TimeSlot,StatusOfRoom)VALUES ('Marina' ,'8-9', 'free' )
SELECT * FROM RoomDetails


CREATE TABLE CheckInDetails (UserId INT , RoomName VARCHAR(20), TimeSlot VARCHAR(20), CheckedIn BIT)

CREATE PROCEDURE InsertUserBookingData(@UserId INT , @RoomName VARCHAR(20), @TimeSlot VARCHAR(10))
AS
BEGIN
	INSERT INTO UserBookingDetails ([UserId],[RoomName],[TimeSlot])
	VALUES (@UserId,@RoomName,@TimeSlot)
	UPDATE RoomDetails
	SET StatusOfRoom = @UserId
	WHERE RoomName = @RoomName AND TimeSlot=@TimeSlot ;	
END

EXEC InsertUserBookingData '2159', 'Pondy', '10-11'


CREATE PROCEDURE CheckOutAnUser (@UserId INT , @RoomName VARCHAR(20), @TimeSlot VARCHAR(10))
AS
BEGIN
	DELETE
	FROM
    UserBookingDetails
	WHERE
    UserId = @UserId AND RoomName = @RoomName AND TimeSlot = @TimeSlot;
	UPDATE RoomDetails
	SET StatusOfRoom = 'free'
	WHERE RoomName = @RoomName AND TimeSlot=@TimeSlot AND StatusOfRoom=@UserId;	 
END	

EXEC CheckOutAnUser '2159', 'Pondy' ,'10-11'

CREATE PROC GetAvailability (@TimeSlot VARCHAR(20))
AS
BEGIN
	SELECT RoomName , StatusOfRoom FROM RoomDetails
	WHERE TimeSlot = @TimeSlot
END

EXEC GetAvailability '3-4'

SELECT * FROM RoomDetails
SELECT * FROM UserBookingDetails
SELECT * FROM CheckInDetails


